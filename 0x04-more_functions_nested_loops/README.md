additional functions and nested loops
